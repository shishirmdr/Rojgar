{% extends "base.html" %}
{% load static %}

{% block content %}
	<div class="container p-5">
		<div class="card">
			<div class="card-header"> <h4>{{ profile.user.username }}'s Profile</h4></div>
			<div class="card-body">
				<div class="row">
					<div class="col-lg-5 col-12 col-sm-6 col-xl-4">
						<img src={{ profile.image.url }} height="60%" width="100%">
					</div>
					<div class="col-lg-9 col-12 col-sm-6 col-xl-8">
						<div class="container">
							<div class="row">
								<div class="col">
									<h2>{{ profile.user.username }}</h2>
									<p>
										<span class="sml-text">Occupation :</span>
											{% if profile.occupation %}
												<b>{{ profile.occupation }}</b>
											{% else %}
												<i class="fas fa-times-circle" style="color:red; width=30px;"></i>
											{% endif %}
										<p>
											{% if profile.description %}
												{{profile.description}}
											{% endif %}
										</p>
<!--                                         <p>
											{% if profile.category %}
												{{profile.category}}
											{% endif %}
										</p> -->
									</p>
								</div>
								<div class="col-lg-9 col-12 col-sm-6 col-xl-5 m-3">
									{% if profile.available_for_hire %}
										{% if user.id != profile.user.id %}
											<div><h3>
													NRs. {{ profile.price}}</h3>
											</div>
											<form action="{% url 'user-action' profile.user.id 'hire' %}" method="POST">
												{% csrf_token %}
												{% if involved %}
													<button class="btn btn-light btn-lg p-2" disabled> Hire </button>
												{% else %}
													<button class="btn btn-success btn-lg p-2"> Hire </button>
												{% endif %}
											</form>
										{% endif %}
									{% endif %}
									{% if user.is_authenticated %}
                    {% if user.id != profile.user.id %}
  										<div style="margin-top: 20px;" class="favourite">
  											<form methd="POST" action="{% url 'add-favourite' profile.user.id %}">
  												{% csrf_token %}
  												<button type='submit' class='btn btn-light'>
  													{% if is_favourite %}
  														<i class="fas fa-heart"></i>
  													{% else %}
  														<i class="far fa-heart"></i>
  													{% endif %}
  												</button>
  											</form>
  										</div>
                    {% endif %}
									{% endif %}
								</div>
							</div>
						</div>
						<hr>
						<ul class="container details" style="list-style-type:none;">
							<li>
								<p>
									<i class="fas fa-envelope" style="width:30px; color:#48b4e0"></i>
									{% if profile.user.email %}
										{{ profile.user.email }}
									{% else %}
										<i class="fas fa-times-circle" style="color:red; width=30px;"></i>
									{% endif %}
								</p>
							</li>
							<li>
								<p>
									<i class="fas fa-user-graduate" style="width:30px; color: #48b4e0"></i>
									{% if profile.education %}
										{{ profile.education }}
									{% else %}
										<i class="fas fa-times-circle" style="color:red; width=30px;"></i>
									{% endif %}
								</p>
							</li>
							<li>
								<p>
									<i class="fas fa-globe" style="width:30px; color:#48b4e0"></i>
									{% if profile.website %}
										<a href="{{ profile.website }}"> {{ profile.website }}</a> {% else %}
										<i class="fas fa-times-circle" style="color:red; width=30px;"></i>
									{% endif %}
								</p>
							</li>
							<!-- <li>
								<p>
									<b>Available for hire : </b>
									{% if profile.available_for_hire %}
										<i class="fas fa-check" style="color:green"></i>
									{% else %}
										<i class="fas fa-times" style="color:red"></i>
									{% endif%}
								</p>
							</li> -->
						</ul>
						<hr>
						<div class="col-md-10 col-6 tital">
							<p>
								<span class="sml-text">Member Since: </span>
								<b>{{ profile.user.date_joined.date }}</b>
							</p>
							{% if profile.skills %}
								<p>
									<span class="sml-text">Tags : </span>
									{% for skill in profile.skills.all %}
										 <a href="{% url 'tag-details' skill.slug %}" class="btn btn-info btn-sm" style="border-radius: 2em;min-width: 5em;"> <span class="tag-title">{{ skill }}</span> </a>
									{% endfor %}
								</p>
							{% endif %}
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="container mt-4">
		{% if user.is_authenticated %}
			{% if not already_commented %}
			{% if user.id != profile.user.id %}
				<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapseExample"
						aria-expanded="false" aria-controls="collapseExample">
					Post Comment
				</button>
				<div class="collapse" id="collapseExample">
					<div>
						<form method="POST" action="{% url 'comment-view' profile.user.id %}">
							{% csrf_token %}
							<div class="form-group mt-3">
								<label for="id_body"><b>Comment Box</b></label>
								<textarea name="body" class="form-control" id="id_body"></textarea>
							</div>
							<button type="submit" class="btn btn-success">Post</button>
						</form>
					</div>
				</div>
			{% endif %}
			{% endif %}
		{% endif %}
		<h2>All Comments</h2>
		{% for comment in comments %}
			<section id="comments mt-4">
				<div class="media comment-box ">
					<img src="http://placehold.it/55x55" alt="media object image">
					<div class="media-body ml-3">
						<p><b>{{ comment.user.username}}</b> says,<br/>
						{{ comment.body }}</p>
					</div>
				</div>
			<hr>
			</section>
		{% empty %}
			<section id="comment mt-4">
				<div class="media">
					<p>No comments yet.</p>
				</div>
			</section>
		{% endfor %}
		</div>
	</div>
{% endblock %}
