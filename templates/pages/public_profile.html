{% extends "base.html" %}
{% load static %}

{% block content %}
	<div class="service pb-4" style="min-height: 100vh;">
		<div class="container">
			<div class="row">
				<div class="col-12 col-md-4">
					<div class="card user-card">
						<div class="card-body">
							<div class="dashboardmain">
								<div class="dashuserimg">
									{% if profile.image %}
										<img src={{ profile.image.url }} height="100%" width="100%" style="object-fit: cover;object-position: center center;">
									{% else %}
										<img src="{% static 'images/default_profile_pic.png' %} " height="100%" width="100%">
									{% endif %}
								</div>
							</div>
							<div style="text-align: center;font-size: 50px;">{{ profile.user.username }}</div>
							
							{% if profile.available_for_hire %}
								<div class="clearfix pt-3">
									
									{% if user.id != profile.user.id %}
										<div class="float-left">
											<form action="{% url 'user-action' profile.user.id 'hire' %}" method="POST">
												{% csrf_token %}
												{% if involved %}
													<button class="btn btn-light px-2" disabled> Hire </button>
												{% else %}
													<button class="btn btn-success px-4"> Hire </button>
												{% endif %}
											</form>
										</div>
									{% endif %}
									
									{% if user.is_authenticated %}
										{% if user.id != profile.user.id %}
											<div class="favourite float-right">
												<form methd="POST" action="{% url 'add-favourite' profile.user.id %}">
													{% csrf_token %}
													<button type='submit' class='btn btn-light'>
														{% if is_favourite %}
															<i class="fas fa-heart" style="color: red;"></i>
														{% else %}
															<i class="far fa-heart"></i>
														{% endif %}
													</button>
												</form>
											</div>
										{% endif %}
									{% endif %}
								</div>
							{% endif %}
						</div>
					</div>
					<div class="card user-card">
						<div class="card-body text-center">
							<div class="row mb-3">
								<div class="col-6">
									<b class="text-warning" style="font-size: 45px;">0</b> <br/>
									<b class="text-secondary">Jobs Done</b>
								</div>
								<div class="col-6">
									<b class="text-warning" style="font-size: 45px;">0</b> <br/>
									<b class="text-secondary">Jobs Requested</b>
								</div>
							</div>
							<hr/>
							<span class="sml-text">Member Since {{ profile.user.date_joined.date }}</span>
						</div>
					</div>
				</div>

				{% if profile.available_for_hire %}
					<div class="col-12 col-md-8">
						<div class="card user-card">
							<div class="card-body">
								<div class="row">
									<div class="col-6 py-3">
										<span class="sml-text">Occupation :</span>
										{% if profile.occupation %}
											<b>{{ profile.occupation }}</b>
										{% else %}
											<i class="fas fa-times-circle" style="color:red; width=30px;"></i>
										{% endif %}
									</div>
									<div class="col-6 py-3">
										<!-- <i class="fas fa-envelope" style="width:30px; color:#48b4e0"></i> -->
										<span class="sml-text">Email :</span>
										{% if profile.user.email %}
											<b>{{ profile.user.email }}</b>
										{% else %}
											<i class="fas fa-times-circle" style="color:red; width=30px;"></i>
										{% endif %}
									</div>
									<div class="col-6 py-3">
										<!-- <i class="fas fa-user-graduate" style="width:30px; color: #48b4e0"></i> -->
										<span class="sml-text">Education :</span>
										{% if profile.education %}
											<b>{{ profile.education }}</b>
										{% else %}
											<i class="fas fa-times-circle" style="color:red; width=30px;"></i>
										{% endif %}
									</div>
									<div class="col-6 py-3">
										<!-- <i class="fas fa-globe" style="width:30px; color:#48b4e0"></i> -->
										<span class="sml-text">Webpage :</span>
										{% if profile.website %}
											<a href="{{ profile.website }}"> {{ profile.website }}</a>
										{% else %}
											<i class="fas fa-times-circle" style="color:red; width=30px;"></i>
										{% endif %}
									</div>
									<div class="col-6">
										<span class="sml-text">Price : </span>
										<span style="font-size: 30px;">NRs. <span class="text-success">{{ profile.price }}</span></span>
									</div>
								</div>
								<hr/>
								<span class="sml-text">Tags :</span>
								{% for skill in profile.skills.all %}
									<a href="{% url 'tag-details' skill.slug %}" class="btn btn-info btn-sm" style="border-radius: 2em;min-width: 5em;"> <span class="tag-title">{{ skill }}</span> </a>
								{% endfor %}
								<hr/>
								{% if profile.description %}
									{{profile.description}}
								{% endif %}
							</div>
						</div>

						{% if profile.cover_image %}
						<div class="card user-card">
							<div class="card-body">
								<small>My Work :</small>
								<div id="UserCoverImageIndicators" class="carousel slide mt-3" data-ride="carousel">
									<ol class="carousel-indicators">
										<li data-target="#UserCoverImageIndicators" data-slide-to="0" class="active"></li>
										{% if profile.cover_image2 %}
											<li data-target="#UserCoverImageIndicators" data-slide-to="1"></li>
										{% endif %}
										{% if profile.cover_image3 %}
											<li data-target="#UserCoverImageIndicators" data-slide-to="2"></li>
										{% endif %}
									</ol>
									<div class="carousel-inner">
										<div class="carousel-item active">
											<img class="d-block w-100" src={{ profile.cover_image.url }} alt="First slide">
										</div>
										{% if profile.cover_image2 %}
											<div class="carousel-item">
												<img class="d-block w-100" src="..." alt="Second slide">
											</div>
										{% endif %}
										{% if profile.cover_image3 %}
											<div class="carousel-item">
												<img class="d-block w-100" src="..." alt="Third slide">
											</div>
										{% endif %}
									</div>
									<a class="carousel-control-prev" href="#UserCoverImageIndicators" role="button" data-slide="prev">
										<span class="carousel-control-prev-icon" aria-hidden="true"></span>
										<span class="sr-only">Previous</span>
									</a>
									<a class="carousel-control-next" href="#UserCoverImageIndicators" role="button" data-slide="next">
										<span class="carousel-control-next-icon" aria-hidden="true"></span>
										<span class="sr-only">Next</span>
									</a>
								</div>
							</div>
						</div>
						{% endif %}

						{% if user.is_authenticated %}
							{% if not already_commented %}
								{% if user.id != profile.user.id %}
									<div class="card user-card">
										<div class="card-body">
											<form method="POST" action="{% url 'comment-view' profile.user.id %}">
												{% csrf_token %}
												<div class="form-group">
													<label for="id_body"><b>Write your review here </b></label>
													<textarea name="body" class="form-control" id="id_body"></textarea>
												</div>
												<button type="submit" class="btn btn-success">Post</button>
											</form>
										</div>
									</div>
								{% endif %}
							{% endif %}
						{% else %}
							<div class="card user-card">
								<div class="card-body text-center">
									<a href="{% url 'signup' %}">Sign Up</a> or <a href="{% url 'login' %}">Log In</a> to <b>comment</b> here...
								</div>
							</div>
						{% endif %}

						<div class="accordion" id="accordionExample">
							<div class="card user-card">
								{% if comment_count != 0 %}
									<div class="card-header bg-white" id="headingOne">
										<button class="btn btn-link btn-block text-center collapsed" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="true" aria-controls="collapseOne">
											View All Reviews ({{ comment_count }})
										</button>
									</div>

									<div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionExample">
										<div class="card-body">
											{% for comment in comments %}
												<div class="media">
													<img src="{% static 'images/default_profile_pic.png' %}" class="mr-3 mt-2 rounded-circle" alt="img" width="40px">
													<div class="media-body">
														<div class="mt-0"><b>{{ comment.user.username}}</b> says,</div>
														{{ comment.body }}
													</div>
												</div>
												<hr/>
											{% endfor %}
										</div>
									</div>

								{% else %}
									<div class="card-body text-center text-secondary">
										No Reviews Yet
									</div>
								{% endif %}
							</div>
						</div>
					</div>
				{% endif %}
			</div>
		</div>
	</div>
{% endblock %}
